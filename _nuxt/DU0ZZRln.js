import{a as h}from"./Ds-y25X3.js";import{e as l,l as y,ct as c,bX as v}from"./DFVm4NPh.js";import"./CAb_97xm.js";const Z=l({props:{schema:{type:Object,default:void 0},state:{type:Object,required:!0},validate:{type:Function,default:()=>[]}},setup(e,{slots:n,expose:r}){const a=Math.random().toString(36).substring(7),o=h(`form-${a}`);o.on(async t=>{if(t.type==="blur"){const d=i.value.filter(s=>s.path!==t.path),m=(await u()).filter(s=>s.path===t.path);i.value=d.concat(m)}});const i=y([]);c("form-errors",i),c("form-events",o);async function u(){let t=await e.validate(e.state);if(e.schema)if(p(e.schema))t=t.concat(await S(e.state,e.schema));else if(w(e.schema))t=t.concat(await E(e.state,e.schema));else if(J(e.schema))t=t.concat(await F(e.state,e.schema));else throw new Error("Form validation failed: Unsupported form schema");return t}async function f(){if(i.value=await u(),i.value.length>0)throw new Error(`Form validation failed: ${JSON.stringify(i.value,null,2)}`);return e.state}return r({validate:f}),()=>{var t;return v("form",(t=n.default)==null?void 0:t.call(n))}}});function w(e){return e.validate&&e.__isYupSchema__}function g(e){return e.inner!==void 0}async function E(e,n){try{return await n.validate(e,{abortEarly:!1}),[]}catch(r){if(g(r))return r.inner.map(a=>({path:a.path??"",message:a.message}));throw r}}function p(e){return e.parse!==void 0}function b(e){return e.issues!==void 0}async function S(e,n){try{return n.parse(e),[]}catch(r){if(b(r))return r.issues.map(a=>({path:a.path.join("."),message:a.message}));throw r}}function J(e){return e.validateAsync!==void 0&&e.id!==void 0}function j(e){return e.isJoi===!0}async function F(e,n){try{return await n.validateAsync(e,{abortEarly:!1}),[]}catch(r){if(j(r))return r.details.map(a=>({path:a.path.join("."),message:a.message}));throw r}}export{Z as default};
