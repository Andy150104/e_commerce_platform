import{n as A,i as _,t as b,a as q,b as I,c as g,u as C,d as P}from"./CAb_97xm.js";import{I as S,l as w,cI as O,d8 as B,D as M,af as R,cy as T,bU as W}from"./DFVm4NPh.js";function D(a,f,i){let n;S(i)?n={evaluating:i}:n={};const{lazy:u=!1,evaluating:r=void 0,shallow:d=!0,onError:s=A}=n,t=w(!u),c=d?O(f):w(f);let l=0;return B(async p=>{if(!t.value)return;l++;const e=l;let o=!1;r&&Promise.resolve().then(()=>{r.value=!0});try{const m=await a(L=>{p(()=>{r&&(r.value=!1),o||L()})});e===l&&(c.value=m)}catch(m){s(m)}finally{r&&e===l&&(r.value=!1),o=!0}}),u?M(()=>(t.value=!0,c.value)):c}function h(a){var f;const i=b(a);return(f=i==null?void 0:i.$el)!=null?f:i}const y=P?window:void 0;function E(...a){let f,i,n,u;if(typeof a[0]=="string"||Array.isArray(a[0])?([i,n,u]=a,f=y):[f,i,n,u]=a,!f)return A;Array.isArray(i)||(i=[i]),Array.isArray(n)||(n=[n]);const r=[],d=()=>{r.forEach(l=>l()),r.length=0},s=(l,p,e,o)=>(l.addEventListener(p,e,o),()=>l.removeEventListener(p,e,o)),t=R(()=>[h(f),b(u)],([l,p])=>{if(d(),!l)return;const e=q(p)?{...p}:p;r.push(...i.flatMap(o=>n.map(m=>s(l,o,m,e))))},{immediate:!0,flush:"post"}),c=()=>{t(),d()};return I(c),c}let F=!1;function j(a,f,i={}){const{window:n=y,ignore:u=[],capture:r=!0,detectIframe:d=!1}=i;if(!n)return A;_&&!F&&(F=!0,Array.from(n.document.body.children).forEach(e=>e.addEventListener("click",A)),n.document.documentElement.addEventListener("click",A));let s=!0;const t=e=>u.some(o=>{if(typeof o=="string")return Array.from(n.document.querySelectorAll(o)).some(m=>m===e.target||e.composedPath().includes(m));{const m=h(o);return m&&(e.target===m||e.composedPath().includes(m))}}),l=[E(n,"click",e=>{const o=h(a);if(!(!o||o===e.target||e.composedPath().includes(o))){if(e.detail===0&&(s=!t(e)),!s){s=!0;return}f(e)}},{passive:!0,capture:r}),E(n,"pointerdown",e=>{const o=h(a);s=!t(e)&&!!(o&&!e.composedPath().includes(o))},{passive:!0}),d&&E(n,"blur",e=>{setTimeout(()=>{var o;const m=h(a);((o=n.document.activeElement)==null?void 0:o.tagName)==="IFRAME"&&!(m!=null&&m.contains(n.document.activeElement))&&f(e)},0)})].filter(Boolean);return()=>l.forEach(e=>e())}function k(a,f={}){const{immediate:i=!0,fpsLimit:n=void 0,window:u=y}=f,r=w(!1),d=n?1e3/n:null;let s=0,t=null;function c(e){if(!r.value||!u)return;s||(s=e);const o=e-s;if(d&&o<d){t=u.requestAnimationFrame(c);return}s=e,a({delta:o,timestamp:e}),t=u.requestAnimationFrame(c)}function l(){!r.value&&u&&(r.value=!0,s=0,t=u.requestAnimationFrame(c))}function p(){r.value=!1,t!=null&&u&&(u.cancelAnimationFrame(t),t=null)}return i&&l(),I(p),{isActive:T(r),pause:p,resume:l}}const v=new Map;function N(a){const f=W();function i(s){var t;const c=v.get(a)||new Set;c.add(s),v.set(a,c);const l=()=>u(s);return(t=f==null?void 0:f.cleanups)==null||t.push(l),l}function n(s){function t(...c){u(t),s(...c)}return i(t)}function u(s){const t=v.get(a);t&&(t.delete(s),t.size||r())}function r(){v.delete(a)}function d(s,t){var c;(c=v.get(a))==null||c.forEach(l=>l(s,t))}return{on:i,once:n,off:u,emit:d,reset:r}}function U(a={}){const{controls:f=!1,offset:i=0,immediate:n=!0,interval:u="requestAnimationFrame",callback:r}=a,d=w(g()+i),s=()=>d.value=g()+i,t=r?()=>{s(),r(d.value)}:s,c=u==="requestAnimationFrame"?k(t,{immediate:n}):C(t,u,{immediate:n});return f?{timestamp:d,...c}:d}export{N as a,U as b,D as c,j as o,h as u};
