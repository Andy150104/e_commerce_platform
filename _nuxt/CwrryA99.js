import{e as M,l as m,D as A,g as E,o as p,c as v,a as e,h as R,i as S,t as h,j as B,b as $,w as k,O as P,q,bb as L,aQ as N,d as w,F as O,r as z,L as j,G as V,b5 as T}from"./DFVm4NPh.js";import{V as H}from"./Bug8ffv2.js";import{s as X}from"./DqbQgBaR.js";import{s as G}from"./BuMp5kCj.js";import{_ as K}from"./DlAUqK2U.js";const Q={class:"max-w-6xl mx-auto p-5"},J={key:0,class:"space-y-5"},W={class:"flex flex-col md:flex-row gap-5"},Y={class:"flex-1"},Z={class:"flex-1 flex flex-col items-center justify-center border border-gray-300 p-2 shadow-lg"},ee={class:"text-lg font-semibold mb-2"},te={key:0},oe=["src"],ae={key:1,class:"text-gray-500"},se={class:"flex justify-between mt-5"},re=["disabled"],le=["disabled"],ne=M({__name:"ImageCrop",props:{images:{type:Array,required:!1,default:()=>[]}},emits:["updateCrop"],setup(i,{emit:d}){const l=i,c=d,s=m([]),o=m(0),b=m(1),a=m(null),f=A(()=>s.value[o.value]||{original:""});E(()=>{s.value=[],l.images.forEach(u=>{s.value.push({original:u.original,cropped:""})})});const x=()=>{if(a.value&&a.value.getCroppedCanvas){const u=a.value.getCroppedCanvas();if(u){const g=u.toDataURL("image/png");s.value[o.value].cropped=g,c("updateCrop",{index:o.value,cropped:g})}}},y=()=>{b.value=1,a.value&&a.value.setAspectRatio&&a.value.setAspectRatio(1)},_=()=>{b.value=16/9,a.value&&a.value.setAspectRatio&&a.value.setAspectRatio(16/9)},I=()=>{a.value&&a.value.rotate&&a.value.rotate(-90)},C=()=>{a.value&&a.value.rotate&&a.value.rotate(90)},r=()=>{a.value&&a.value.reset&&a.value.reset()},t=()=>{o.value<s.value.length-1&&o.value++},n=()=>{o.value>0&&o.value--};return(u,g)=>(p(),v("div",Q,[s.value.length?(p(),v("div",J,[e("div",W,[e("div",Y,[e("div",{class:"flex flex-wrap gap-2 mb-3"},[e("button",{onClick:y,class:"px-3 py-2 bg-blue-500 text-white rounded hover:bg-blue-600"},"Hình vuông"),e("button",{onClick:_,class:"px-3 py-2 bg-blue-500 text-white rounded hover:bg-blue-600"},"Hình chữ nhật"),e("button",{onClick:I,class:"px-3 py-2 bg-blue-500 text-white rounded hover:bg-blue-600"},"Xoay trái"),e("button",{onClick:C,class:"px-3 py-2 bg-blue-500 text-white rounded hover:bg-blue-600"},"Xoay phải"),e("button",{onClick:r,class:"px-3 py-2 bg-red-500 text-white rounded hover:bg-red-600"},"Reset")]),(p(),R(S(H),{ref_key:"cropper",ref:a,src:f.value.original,"aspect-ratio":b.value,"auto-crop-area":1,"view-mode":1,"drag-mode":"move",preview:".preview",class:"w-full h-[26rem] bg-gray-100",key:o.value},null,8,["src","aspect-ratio"])),e("button",{onClick:x,class:"mt-3 px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600"},"Crop Image")]),e("div",Z,[e("h3",ee,"Ảnh đã cắt ("+h(o.value+1)+" / "+h(s.value.length)+")",1),f.value.cropped?(p(),v("div",te,[e("img",{src:f.value.cropped,alt:"Cropped Image",class:"w-full"},null,8,oe)])):(p(),v("div",ae,"Chưa có ảnh đã cắt."))])]),e("div",se,[e("button",{onClick:n,disabled:o.value===0,class:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed"}," Back ",8,re),e("button",{onClick:t,disabled:o.value===s.value.length-1,class:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed"}," Next ",8,le)])])):B("",!0)]))}}),ie={class:"flex-grow w-full h-auto p-6"},de=M({__name:"ModelFullScreen",props:{label:{type:String,required:!1,default:"Open"},isShowButton:{type:Boolean,required:!1,default:!0}},setup(i,{expose:d}){const l=m(!1),c=s=>{l.value=s};return d({isOpenModal:c}),(s,o)=>{const b=G,a=X;return p(),v("div",null,[i.isShowButton?(p(),R(b,{key:0,label:i.label,onClick:o[0]||(o[0]=()=>c(!0))},null,8,["label"])):B("",!0),$(a,{visible:l.value,"onUpdate:visible":o[1]||(o[1]=f=>l.value=f),modal:"",style:{width:"100vw",height:"100vh"},class:"custom-dialog"},{header:k(()=>o[2]||(o[2]=[e("div",{class:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700"},[e("h3",{class:"text-base font-semibold leading-6 text-gray-900 dark:text-white text-center"},"Modal")],-1)])),footer:k(()=>o[3]||(o[3]=[e("div",{class:"p-4 border-t border-gray-200 dark:border-gray-700"},null,-1)])),default:k(()=>[e("div",ie,[P(s.$slots,"body",{},void 0,!0)])]),_:3},8,["visible"])])}}}),ue=K(de,[["__scopeId","data-v-30fb7f8d"]]),pe=q("Upload Image",{state:()=>({uploadImage:[]}),getters:{},actions:{ResetStore(){this.uploadImage=[]},SetUploadImage(i,d,l){this.uploadImage.push({name:i,size:d,imagePreview:l})},SetImage(i){this.ResetStore(),i.forEach(d=>{this.uploadImage.push({name:"image",size:1024,imagePreview:d})})},async uploadCloudinaryBase64(i){const d="dbfokyruf",l="EcomBox",c=`https://api.cloudinary.com/v1_1/${d}/upload`,s=new FormData;s.append("file",i),s.append("upload_preset",l);try{return(await L.post(c,s)).data.secure_url}catch(o){throw console.error("Error uploading base64 image to Cloudinary:",o),o}}}}),ce={class:"w-full p-6 bg-white dark:bg-gray-800 rounded-lg shadow-lg"},ge={class:"mb-4"},me={class:"text-gray-600 dark:text-gray-400"},ve={class:"flex items-center"},be=["onMouseover","onMouseleave"],fe={class:"text-sm font-medium text-gray-700 dark:text-gray-300 cursor-pointer lg:text-lg"},he={class:"ml-4 text-sm text-gray-600 dark:text-gray-400"},xe=["onClick"],ye={class:"absolute z-10 w-[280px] p-3 text-sm text-gray-500 bg-white border border-gray-200 rounded-lg shadow dark:text-gray-400 dark:border-gray-600 dark:bg-gray-800 translate-y-5 -translate-x-2"},we=["src"],$e=M({__name:"UserControlUploadImage",props:{maxNumberImage:{type:Number,required:!0,default:5},isShowPopover:{type:Boolean,required:!1,default:!0},label:{type:String,required:!1,default:"Upload Image"}},setup(i){const d=i,l=pe(),c=m([]),s=m([]),o=m(!1),b=m(),a=r=>{var n;if(!((n=r.dataTransfer)!=null&&n.files))return;const t=Array.from(r.dataTransfer.files);x(t)},f=r=>{const t=r.target;if(!t.files)return;const n=Array.from(t.files);n.length>d.maxNumberImage||(x(n),t.value="")};function x(r){let t=l.uploadImage.length;if(t!==d.maxNumberImage)for(const n of r){const u=+(n.size/1024/1024).toFixed(2),g=new FileReader;g.onload=U=>{var D;const F=(D=U.target)==null?void 0:D.result;l.SetUploadImage(`image${t+1}.png`,u,F),s.value.push(!1),t++},g.readAsDataURL(n)}}const y=r=>{s.value[r]=!s.value[r]},_=r=>{l.uploadImage.splice(r,1),s.value.splice(r,1)},I=async()=>{c.value=l.uploadImage.map(r=>({original:r.imagePreview,cropped:""})),b.value.isOpenModal(!0),await j()},C=({index:r,cropped:t})=>{l.uploadImage[r].imagePreview=t};return(r,t)=>(p(),v("div",null,[e("div",ce,[e("div",ge,[t[3]||(t[3]=e("label",{for:"file-upload",class:"block text-base font-semibold mb-2 dark:text-white"},"Upload Image",-1)),S(l).uploadImage.length<i.maxNumberImage?(p(),v("div",{key:0,class:"relative border-2 border-dashed border-gray-300 dark:border-gray-700 rounded-lg p-6 text-center cursor-pointer hover:border-blue-500",onDrop:N(a,["prevent"]),onDragover:t[0]||(t[0]=N(()=>{},["prevent"]))},[e("input",{type:"file",id:"file-upload",accept:"image/*",multiple:"",class:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",onChange:f},null,32),e("p",me,[t[1]||(t[1]=w(" Kéo thả (Drag & Drop) hoặc ")),t[2]||(t[2]=e("span",{class:"text-blue-500 underline"},"chọn file",-1)),w(" để upload"+h("(tối đa "+d.maxNumberImage+"  ảnh)"),1)])],32)):B("",!0)]),(p(!0),v(O,null,z(S(l).uploadImage,(n,u)=>(p(),v("div",{key:u,class:"relative w-full max-w-md p-4 mb-4 bg-slate-300 dark:bg-gray-800 rounded-lg shadow-lg"},[e("div",ve,[e("div",{onMouseover:g=>y(u),onMouseleave:g=>y(u)},[e("h3",fe,h(n.name),1)],40,be),e("span",he,h(n.size)+" MB",1),e("button",{class:"ml-auto text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",onClick:g=>_(u)},t[4]||(t[4]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,xe)]),V(e("div",ye,[t[7]||(t[7]=e("div",{class:"mb-2 font-semibold text-gray-900 dark:text-white"},"Image Info",-1)),e("img",{src:n.imagePreview,alt:""},null,8,we),e("p",null,[t[5]||(t[5]=e("strong",null,"Name:",-1)),w(" "+h(n.name),1)]),e("p",null,[t[6]||(t[6]=e("strong",null,"Size:",-1)),w(" "+h(n.size)+" MB",1)])],512),[[T,s.value[u]&&i.isShowPopover]])]))),128)),e("div",{class:"flex justify-end mt-4"},[e("button",{class:"text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800",onClick:I}," Edit ")])]),$(ue,{ref_key:"isOpenModal",ref:b,label:"Edit","is-show-button":!1,"is-open-modal":o.value},{body:k(()=>[$(ne,{images:c.value,onUpdateCrop:C},null,8,["images"])]),_:1},8,["is-open-modal"])]))}});export{$e as _,pe as u};
